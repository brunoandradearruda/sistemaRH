<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Cadastro de Servidor</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#CPF').mask('000.000.000-00', {reverse: true});
            $('#CEP').mask('00000-000', {reverse: true});
            $('#PisPasep').mask('000.00000.00-0', {reverse: true});
            $('#matricula').mask('000.000-0', {reverse: true});
            // Adiciona um ouvinte de evento ao formulário
            $('form').submit(function() {
                // Exibe o alerta após o envio do formulário
                alert('Cadastro realizado com sucesso!');
            });
        });
    </script>


</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse text-center" id="navbarNav">
        <ul class="navbar-nav mx-auto">

            <li class="nav-item">
                <a class="nav-link" href="/home">Página Inicial</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Férias</a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Setor
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/setor">Consultar</a>
                    <a class="dropdown-item" href="/cadastrar-departamento">Cadastrar</a>
                </div>
            </li>

            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Servidores
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/servidorlista">Consultar</a>
                    <a class="dropdown-item" href="/servidor">Cadastrar</a>
                </div>
            </li>

            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Cargos
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/cargoslista">Consultar</a>
                    <a class="dropdown-item" href="/cargo">Cadastrar</a>
                </div>
            </li>

        </ul>
    </div>
</nav>

<div class="container">
    <h1 class="mt-5">Cadastro de Servidor</h1>
    <form action="#" th:action="@{/servidor}" method="post" class="mt-4">
        <!-- Outros campos... -->

        <div class="row">
            <div class="form-group col-md-2">
                <label for="matricula">Matrícula:</label>
                <input type="text" id="matricula" name="matricula" placeholder="Insira a matrícula" class="form-control" required/>
            </div>

            <div class="form-group col-md-2">
                <label for="PisPasep">PIS/PASEP:</label>
                <input type="text" id="PisPasep" name="PisPasep" placeholder="PIS/PASEP " class="form-control" onblur="converterParaMaiusculas(this)" required/>
            </div>

            <div class="form-group col-md-8">
                <label for="nome">Nome:</label>
                <input type="text" id="nome" name="nome" placeholder="Insira o nome do servidor" class="form-control" onblur="converterParaMaiusculas(this)" required/>
            </div>
        </div>



        <div class="row">
            <div class="form-group col-md-2">
                <label for="sexo">Gênero:</label>
                <select id="sexo" name="sexo" class="form-control" onblur="converterParaMaiusculas(this)" required>
                    <option value="">Gênero</option>
                    <option value="CISGÊNERO">CISGÊNERO</option>
                    <option value="TRANSGÊNERO">TRANSGÊNERO</option>
                    <option value="NÃO-BINÁRIO">NÃO-BINÁRIO</option>
                    <option value="GÊNERO-FLUIDO">GÊNERO-FLUIDO</option>
                    <option value="AGÊNERO">AGÊNERO</option>
                    <option value="BIGÊNERO">BIGÊNERO</option>
                    <option value="DEMIBOY/DEMIGIRL">DEMIBOY/DEMIGIRL</option>
                    <option value="NEUTROIS">NEUTROIS</option>
                    <option value="ANDRÓGINO">ANDRÓGINO</option>
                    <option value="TWO-SPIRIT">TWO-SPIRIT</option>
                </select>
            </div>

            <div class="form-group col-md-2">
                <label for="CPF">CPF:</label>
                <input type="text" id="CPF" name="CPF" placeholder="Insira o CPF do servidor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="identidade">Identidade:</label>
                <input type="text" id="identidade" name="identidade" placeholder="Insira a identidade do servidor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="orgaoExpeditor">Órgão Expeditor:</label>
                <input type="text" id="orgaoExpeditor" name="orgaoExpeditor" placeholder="Insira o órgão expeditor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="telefone">Telefone:</label>
                <input type="text" id="telefone" name="telefone" placeholder="(__) _____-____" class="form-control"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="dataNascimento">Data de Nascimento:</label>
                <input type="date" id="dataNascimento" name="dataNascimento" class="form-control"required/>
            </div>
        </div>



        <div class="row">
            <div class="form-group col-md-2">
                <label for="CEP">CEP:</label>
                <input type="text" id="CEP" name="CEP" placeholder="Insira o CEP do servidor" class="form-control" onblur="pesquisacep(this.value);"required/>
            </div>

            <div class="form-group col-md-5">
                <label for="endereco">Endereço:</label>
                <input type="text" id="endereco" name="endereco" placeholder="Insira o endereço do servidor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="bairro">Bairro:</label>
                <input type="text" id="bairro" name="bairro" placeholder="Insira o bairro do servidor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-2">
                <label for="cidade">Cidade:</label>
                <input type="text" id="cidade" name="cidade" placeholder="Insira a cidade do servidor" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>

            <div class="form-group col-md-1">
                <label for="estado">Estado:</label>
                <input type="text" id="estado" name="estado" placeholder="UF" class="form-control" onblur="converterParaMaiusculas(this)"required/>
            </div>
        </div>



        <div class="row">
            <div class="form-group col-md-2">
                <label for="dataAdmissão">Data de Admissão:</label>
                <input type="date" id="dataAdmissão" name="dataAdmissão" class="form-control"/>
            </div>

            <div class="form-group col-md-2">
                <label for="cargo">Cargo:</label>
                <select id="cargo" name="cargo" class="form-control">
                    <option th:each="cargo : ${cargos}" th:value="${cargo.id}" th:text="${cargo.nome}"></option>
                </select>
            </div>


            <div class="form-group col-md-2">
                <label for="simbolo">Símbolo:</label>
                <input type="text" id="simbolo" name="simbolo" placeholder="Insira o símbolo do servidor" class="form-control"/>
            </div>

            <div class="form-group col-md-2">
                <label for="funcao">Função:</label>
                <input type="text" id="funcao" name="funcao" placeholder="Insira a função do servidor" class="form-control"/>
            </div>

            <div class="form-group col-md-4">
                <label for="setor">Setor:</label>
                <input type="text" id="setor" name="setor" placeholder="Insira o setor do servidor" class="form-control"/>
            </div>
        </div>










        <!-- Outros campos... -->

        <button type="submit" class="btn btn-primary">Cadastrar</button>
    </form>
</div>

<script>
    $(document).ready(function () {
        // Máscara para telefone
        $('#telefone').mask('(00) 00000-0000');
    });

    function limpa_formulário_cep() {
        // Limpa valores do formulário de cep.
        $("#endereco").val("");
        $("#bairro").val("");
        $("#cidade").val("");
        $("#estado").val("");
    }

    async function preenche_campos(cep) {
        try {
            const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
            const dados = await response.json();

            if (!("erro" in dados)) {
                // Atualiza os campos com os valores da consulta.
                $("#endereco").val(dados.logradouro);
                $("#bairro").val(dados.bairro);
                $("#cidade").val(dados.localidade);
                $("#estado").val(dados.uf);
            } else {
                // CEP pesquisado não foi encontrado.
                limpa_formulário_cep();
                alert("CEP não encontrado.");
            }
        } catch (error) {
            console.error('Erro ao buscar CEP:', error);
        }
    }

    function pesquisacep(valor) {
        // Nova variável "cep" somente com dígitos.
        var cep = valor.replace(/\D/g, '');

        // Verifica se o campo cep possui valor informado.
        if (cep !== "") {
            // Expressão regular para validar o CEP.
            var validacep = /^[0-9]{8}$/;

            // Valida o formato do CEP.
            if (validacep.test(cep)) {
                // Preenche os campos com "..." enquanto consulta webservice.
                limpa_formulário_cep();

                // Consulta o webservice viacep.com.br/
                preenche_campos(cep);
            } else {
                // CEP é inválido.
                limpa_formulário_cep();
                alert("Formato de CEP inválido.");
            }
        } else {
            // CEP sem valor, limpa formulário.
            limpa_formulário_cep();
        }
    }

    function converterParaMaiusculas(elemento) {
        elemento.value = elemento.value.toUpperCase();
    }
</script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
